<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Loja — Valdo Criações</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/styles.css">
<style>
  /* cartões e imagens contidas */
  .card .thumb{ aspect-ratio:4/3; background:#0d0f14; overflow:hidden; display:flex; align-items:center; justify-content:center }
  .card .thumb img{ width:100%; height:100%; object-fit:cover; display:block; cursor:zoom-in }
  /* grelha normal */
  .grid{ gap:16px; }
  /* grelha densa quando há muitos itens (ex.: canecas) */
  .grid.dense{ grid-template-columns:repeat(5,1fr); gap:12px }
  .grid.dense .card .thumb{ aspect-ratio:1/1 }
  .grid.dense .card .body{ padding:10px }
  .grid.dense .card h3{ font-size:14px }
  .grid.dense .muted{ font-size:12px }
  .grid.dense .price{ font-size:13px }
  /* lightbox (zoom) */
  #zoom{ position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.85); z-index:9999; padding:20px }
  #zoom img{ max-width:95vw; max-height:90vh; display:block }
  #zoom.closeable{ cursor:zoom-out }
</style>
<!-- soft lock (opcional). se não quiseres, apaga este bloco -->
<meta name="robots" content="noindex,nofollow">
<script>
(function(){
  const KEY = "VALDO2025";
  const ok = localStorage.getItem("gate_ok") === KEY;
  const params = new URLSearchParams(location.search);
  if (ok || params.get("k") === KEY) { if (params.get("k") === KEY) localStorage.setItem("gate_ok", KEY); return; }
  document.write(`
    <style>body{margin:0;background:#0f1115;color:#e6e9ef;font-family:Inter,system-ui,sans-serif}.gate{min-height:100svh;display:grid;place-items:center}
    .card{max-width:520px;background:#121826;border:1px solid #2a3040;border-radius:14px;padding:22px}
    input,button{padding:12px;border-radius:10px;border:1px solid #2b3140;background:#0f131c;color:#e6e9ef}.row{display:flex;gap:8px}.fine{color:#9aa4b2;font-size:12px;margin-top:8px}</style>
    <div class="gate"><div class="card"><h2 style="margin:0 0 10px">Acesso restrito</h2><p class="fine">Usa a chave partilhada.</p>
    <div class="row" style="margin-top:10px"><input id="pass" placeholder="Chave de acesso" style="flex:1"><button id="go">Entrar</button></div>
    <p class="fine">Ou abre com ?k=${KEY}</p></div></div>
    <script>document.getElementById('go').onclick=function(){const v=document.getElementById('pass').value.trim();if(v==='${KEY}'){localStorage.setItem('gate_ok','${KEY}');location.reload()}else alert('Chave incorreta')};<\/script>
  `);
})();
</script>
</head>
<body>
<header>
  <div class="container nav">
    <div class="brand">
      <a class="logo" href="index.html" style="display:grid;place-items:center;color:#111;font-weight:800;text-decoration:none">V</a>
      <div><strong>Valdo Criações</strong><br><span class="fine">Sublimação & Impressão 3D</span></div>
    </div>
    <div>
      <a class="btn" href="index.html">Início</a>
      <a class="btn" href="https://wa.me/351919707023?text=Ol%C3%A1%2C%20quero%20encomendar" target="_blank" rel="noopener">WhatsApp</a>
    </div>
  </div>
</header>

<main class="container">
  <h1>Loja</h1>

  <div class="tabs" id="cats"></div>
  <div class="tabs" id="subcats"></div>
  <div class="tabs" id="groups"></div> <!-- NOVO: 3º nível -->

  <div class="toolbar">
    <div class="search">
      <input id="q" placeholder="Procurar produto por nome/descrição..." />
      <a id="clear" class="btn">Limpar</a>
    </div>
  </div>

  <section>
    <div class="grid" id="grid"></div>
  </section>
</main>

<footer>
  <div class="container fine">© 2025 Valdo Criações — Envios CTT. Pagamento por <strong>MB Way</strong>. Contacto: 919 707 023</div>
</footer>

<!-- JSON embutido: podes editar nomes, grupos e items aqui -->
<script id="prod-json" type="application/json">{
  "categorias": [
    {
      "nome": "Artigos de Sublimação",
      "subcategorias": [
        {
          "nome": "Têxteis",
          "grupos": [
            {
              "nome": "Sweatshirts",
              "items": [
                {
                  "titulo": "Sweatshirt Namastê",
                  "descricao": "Sublimação HD, 260–265 g/m².",
                  "preco": "€24,90",
                  "imagem": "https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=600&auto=format&fit=crop",
                  "whats": "Sweatshirt Namastê S-XXL — MB Way"
                }
              ]
            },
            {
              "nome": "T-shirts",
              "items": [
                {
                  "titulo": "T-shirt técnica branca",
                  "descricao": "Poliéster leve para sublimação.",
                  "preco": "€12,90",
                  "imagem": "https://images.unsplash.com/photo-1542060748-10c28b62716f?q=80&w=600&auto=format&fit=crop",
                  "whats": "T-shirt técnica branca — MB Way"
                }
              ]
            }
          ]
        },
        {
          "nome": "Cerâmica",
          "grupos": [
            {
              "nome": "Canecas",
              "items": [
                {
                  "titulo": "Caneca 330 ml",
                  "descricao": "Resistente à máquina de lavar.",
                  "preco": "€9,90",
                  "imagem": "https://images.unsplash.com/photo-1517705008128-361805f42e86?q=80&w=600&auto=format&fit=crop",
                  "whats": "Caneca 330 ml — MB Way"
                },
                {
                  "titulo": "Caneca mágica",
                  "descricao": "Revela a arte com calor.",
                  "preco": "€12,90",
                  "imagem": "https://images.unsplash.com/photo-1514437157375-5ca91890bde7?q=80&w=600&auto=format&fit=crop"
                },
                {
                  "titulo": "Caneca interior colorido",
                  "descricao": "Várias cores de interior.",
                  "preco": "€10,90",
                  "imagem": "https://images.unsplash.com/photo-1526318472351-c75fcf070305?q=80&w=600&auto=format&fit=crop"
                }
              ]
            },
            {
              "nome": "Azulejos / Mosaicos",
              "items": [
                {
                  "titulo": "Azulejo 15×15",
                  "descricao": "Cerâmica personalizada por sublimação.",
                  "preco": "€12,00",
                  "imagem": "https://images.unsplash.com/photo-1601397922721-4324df3dc42d?q=80&w=600&auto=format&fit=crop"
                }
              ]
            }
          ]
        },
        {
          "nome": "Diversos",
          "items": [
            {
              "titulo": "Base de rato personalizada",
              "descricao": "Textura confortável; impressão nítida.",
              "preco": "€7,50",
              "imagem": "https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=600&auto=format&fit=crop"
            }
          ]
        }
      ]
    },
    {
      "nome": "3D",
      "subcategorias": [
        {
          "nome": "Resina 3D",
          "items": [
            {
              "titulo": "Miniatura em resina (alto detalhe)",
              "descricao": "Acabamento fino; pintura opcional.",
              "preco": "desde €29,00",
              "imagem": "https://images.unsplash.com/photo-1557814769-96d38c6f7e8d?q=80&w=600&auto=format&fit=crop",
              "whats": "Miniatura resina 3D — orçamento"
            }
          ]
        },
        {
          "nome": "PLA & PETG",
          "items": [
            {
              "titulo": "Peça técnica PLA/PETG",
              "descricao": "Peças funcionais; várias cores.",
              "preco": "sob orçamento",
              "imagem": "https://images.unsplash.com/photo-1541417904950-b855846fe074?q=80&w=600&auto=format&fit=crop",
              "whats": "Peça técnica PLA/PETG — orçamento"
            }
          ]
        }
      ]
    }
  ]
}</script>

<script>
  const TEL = "351919707023";
  const state = {cat:null, sub:null, grp:null, q:""};

  function getData(){
    try{ return JSON.parse(document.getElementById('prod-json').textContent); }
    catch(e){ alert("JSON interno inválido: " + e.message); return {categorias:[]} }
  }
  function el(tag, cls, txt){ const e=document.createElement(tag); if(cls) e.className=cls; if(txt) e.textContent=txt; return e; }

  function renderCats(data){
    const catsEl = document.getElementById("cats");
    catsEl.innerHTML = "";
    (data.categorias||[]).forEach(c => {
      const b = el("div", "tab" + (state.cat===c.nome?' active':''), c.nome);
      b.onclick = () => { state.cat=c.nome; state.sub=null; state.grp=null; state.q=""; const q=document.getElementById("q"); if(q) q.value=""; render(data); };
      catsEl.appendChild(b);
    });
    if(!state.cat && data.categorias && data.categorias[0]) state.cat = data.categorias[0].nome;
  }

  function renderSubcats(data){
    const subEl = document.getElementById("subcats");
    subEl.innerHTML = "";
    const cat = (data.categorias||[]).find(c => c.nome===state.cat);
    if(!cat) return;
    (cat.subcategorias||[]).forEach(s => {
      const b = el("div", "subtab" + (state.sub===s.nome?' active':''), s.nome);
      b.onclick = () => { state.sub=s.nome; state.grp=null; state.q=""; const q=document.getElementById("q"); if(q) q.value=""; renderGroups(data); renderGrid(data); };
      subEl.appendChild(b);
    });
    if(!state.sub && cat.subcategorias && cat.subcategorias[0]) state.sub = cat.subcategorias[0].nome;
  }

  function renderGroups(data){
    const grpEl = document.getElementById("groups");
    grpEl.innerHTML = "";
    const cat = (data.categorias||[]).find(c => c.nome===state.cat);
    if(!cat) return;
    const sub = (cat.subcategorias||[]).find(s => s.nome===state.sub);
    if(!sub || !Array.isArray(sub.grupos)) { state.grp=null; return; }

    sub.grupos.forEach(g => {
      const b = el("div", "subtab" + (state.grp===g.nome?' active':''), g.nome);
      b.onclick = () => { state.grp=g.nome; state.q=""; const q=document.getElementById("q"); if(q) q.value=""; renderGrid(data); };
      grpEl.appendChild(b);
    });
    if(!state.grp && sub.grupos[0]) state.grp = sub.grupos[0].nome;
  }

  function matchQ(item){
    if(!state.q) return true;
    const q = state.q.toLowerCase();
    return (item.titulo||"").toLowerCase().includes(q) || (item.descricao||"").toLowerCase().includes(q);
  }

  function renderGrid(data){
    const grid = document.getElementById("grid");
    grid.innerHTML = "";
    const cat = (data.categorias||[]).find(c => c.nome===state.cat); if(!cat) return;
    const sub = (cat.subcategorias||[]).find(s => s.nome===state.sub); if(!sub) return;

    let items = [];
    if (Array.isArray(sub.grupos) && sub.grupos.length){
      const grp = sub.grupos.find(g => g.nome===state.grp) || sub.grupos[0];
      items = (grp.items||[]).filter(matchQ);
    } else {
      items = (sub.items||[]).filter(matchQ);
    }

    if(items.length >= 8) grid.classList.add("dense"); else grid.classList.remove("dense");

    if(items.length===0){ grid.appendChild(el("p","muted","Sem produtos nesta vista.")); return; }

    items.forEach(it => {
      const card = el("article","card");
      const thumb = el("div","thumb");
      const img = new Image();
      img.src = it.imagem || "https://images.unsplash.com/photo-1503602642458-232111445657?q=80&w=600&auto=format&fit=crop";
      img.loading = "lazy";
      img.onclick = () => openZoom(img.src);
      thumb.appendChild(img);

      const body = el("div","body");
      const h = el("h3","title", it.titulo||"Produto");
      const d = el("p","muted", it.descricao||"");
      const p = el("div","price", it.preco||"");
      const cta = el("div","cta");
      const w = el("a","btn primary","Pedir via WhatsApp (MB Way)");
      const msgBase = (it.whats || `Olá, quero encomendar: ${it.titulo||"Produto"}`);
      const msg = encodeURIComponent(`${msgBase}${it.preco ? ` — ${it.preco}` : ""} — Pagamento: MB Way`);
      w.href = "https://wa.me/" + TEL + "?text=" + msg; w.target = "_blank";
      cta.appendChild(w);

      body.appendChild(h); body.appendChild(d); body.appendChild(p); body.appendChild(cta);
      card.appendChild(thumb); card.appendChild(body);
      grid.appendChild(card);
    });
  }

  function wireSearch(data){
    const q = document.getElementById("q");
    const clear = document.getElementById("clear");
    q.value = state.q || "";
    q.addEventListener("input", () => { state.q = q.value; renderGrid(data); });
    clear.addEventListener("click", () => { q.value=""; state.q=""; renderGrid(data); });
  }

  function render(data){ renderCats(data); renderSubcats(data); renderGroups(data); renderGrid(data); }

  (function start(){
    const data = getData();
    state.q = "";
    render(data);
    wireSearch(data);
  })();
</script>

<!-- overlay para zoom -->
<div id="zoom"><img alt=""></div>
<script>
  const zoomEl = document.getElementById('zoom');
  function openZoom(src){ zoomEl.querySelector('img').src = src; zoomEl.style.display = 'grid'; zoomEl.classList.add('closeable'); }
  zoomEl.addEventListener('click', () => { zoomEl.style.display='none'; zoomEl.querySelector('img').src=''; });
</script>

</body>
</html>
